# TestRetrieveColumnsFromAlignment tests code to convert range strings to lists of lists of integers

from StructureToSequenceAlignment import ConvertIDRangeString
from ReadCorrespondences import ReadCorrespondences
from RetrieveColumnsFromAlignment import RetrieveColumnsFromAlignment

correspondences, header, error = ReadCorrespondences("2QBD_GG16S2012_correspondences.txt")

ranges = ConvertIDRangeString(correspondences,"2QBD|1|A|A|10,2QBD|1|A|G|11:2QBD|1|A|U|14,,2QBD|1|A|U|17")

print ranges

RetrieveColumnsFromAlignment(ranges,'GG16S2012.fasta','TestRetrieveColumnsFromAlignment.tmp')

NTrange = "2QBD|1|A|G|887:2QBD|1|A|G|894,2QBD|1|A|U|905:2QBD|1|A|C|910"


# --------------------------- another test

correspondences, header, error = ReadCorrespondences("2AW7_GG16S2012_correspondences.txt")

NTrange = "2AW7|1|A|C|440:2AW7|1|A|G|442,2AW7|1|A|C|492:2AW7|1|A|G|497,2AW7|1|A|G|1455:2AW7|1|A|G|1457,2AW7|1|A|U|1445:2AW7|1|A|C|1448,2AW7|1|A|G|144:2AW7|1|A|G|146,2AW7|1|A|C|176:2AW7|1|A|C|178,2AW7|1|A|C|1158:2AW7|1|A|C|1161,2AW7|1|A|G|1175:2AW7|1|A|G|1181,2AW7|1|A|G|450:2AW7|1|A|G|454,2AW7|1|A|U|479:2AW7|1|A|C|483,2AW7|1|A|G|774:2AW7|1|A|G|778,2AW7|1|A|U|804:2AW7|1|A|C|805,2AW7|1|A|G|1416:2AW7|1|A|G|1419,2AW7|1|A|U|1481:2AW7|1|A|C|1484,2AW7|1|A|A|1430:2AW7|1|A|G|1435,2AW7|1|A|C|1466:2AW7|1|A|U|1470,2AW7|1|A|C|504:2AW7|1|A|C|511,2AW7|1|A|G|540:2AW7|1|A|G|541,2AW7|1|A|C|779:2AW7|1|A|C|783,2AW7|1|A|G|799:2AW7|1|A|G|803,2AW7|1|A|U|757:2AW7|1|A|G|761,2AW7|1|A|C|580:2AW7|1|A|G|584,2AW7|1|A|G|147:2AW7|1|A|C|153,2AW7|1|A|G|168:2AW7|1|A|C|175,2AW7|1|A|G|446:2AW7|1|A|G|450,2AW7|1|A|C|483:2AW7|1|A|C|488,2AW7|1|A|G|515:2AW7|1|A|G|521,2AW7|1|A|C|528:2AW7|1|A|C|536,2AW7|1|A|C|1399:2AW7|1|A|G|1401,2AW7|1|A|C|1501:2AW7|1|A|G|1504,2AW7|1|A|U|644:2AW7|1|A|G|645,2AW7|1|A|U|594:2AW7|1|A|A|596,2AW7|1|A|G|654:2AW7|1|A|A|655,2AW7|1|A|U|751:2AW7|1|A|C|754,2AW7|1|A|U|1052:2AW7|1|A|U|1056,2AW7|1|A|A|1204:2AW7|1|A|G|1206,2AW7|1|A|U|740:2AW7|1|A|A|743,2AW7|1|A|U|662:2AW7|1|A|G|666,2AW7|1|A|C|1226:2AW7|1|A|C|1228,2AW7|1|A|G|953:2AW7|1|A|G|954,2AW7|1|A|U|1440:2AW7|1|A|G|1442,2AW7|1|A|C|1460:2AW7|1|A|G|1461,2AW7|1|A|A|746:2AW7|1|A|G|748,2AW7|1|A|C|658:2AW7|1|A|U|659,2AW7|1|A|C|54:2AW7|1|A|U|56,2AW7|1|A|A|356:2AW7|1|A|G|357,2AW7|1|A|U|1199:2AW7|1|A|C|1203,2AW7|1|A|G|1057:2AW7|1|A|G|1058,2AW7|1|A|G|1405:2AW7|1|A|C|1407,2AW7|1|A|G|1494:2AW7|1|A|C|1496,2AW7|1|A|G|1486:2AW7|1|A|G|1488,2AW7|1|A|C|1412:2AW7|1|A|U|1414,2AW7|1|A|G|1193:2AW7|1|A|C|1195,2AW7|1|A|G|1061:2AW7|1|A|C|1063,2AW7|1|A|G|1491:2AW7|1|A|G|1494,2AW7|1|A|C|1407:2AW7|1|A|C|1409,2AW7|1|A|U|1247:2AW7|1|A|G|1253,2AW7|1|A|C|1284:2AW7|1|A|G|1290,2AW7|1|A|U|409:2AW7|1|A|G|416,2AW7|1|A|U|427:2AW7|1|A|G|433,2AW7|1|A|G|1041:2AW7|1|A|G|1043,2AW7|1|A|C|998:2AW7|1|A|C|999,2AW7|1|A|C|477:2AW7|1|A|U|479,2AW7|1|A|G|454:2AW7|1|A|G|455,2AW7|1|A|U|472:2AW7|1|A|G|474,2AW7|1|A|U|458:2AW7|1|A|A|459,2AW7|1|A|U|684:2AW7|1|A|G|688,2AW7|1|A|C|699:2AW7|1|A|A|706,2AW7|1|A|U|249:2AW7|1|A|U|252,2AW7|1|A|A|274:2AW7|1|A|G|275,2AW7|1|A|G|1255:2AW7|1|A|G|1258,2AW7|1|A|C|1277:2AW7|1|A|C|1282,2AW7|1|A|G|242:2AW7|1|A|G|247,2AW7|1|A|C|277:2AW7|1|A|C|284,2AW7|1|A|U|605:2AW7|1|A|C|612,2AW7|1|A|G|628:2AW7|1|A|G|633,2AW7|1|A|G|1142:2AW7|1|A|G|1143,2AW7|1|A|C|1129:2AW7|1|A|C|1132,2AW7|1|A|G|213:2AW7|1|A|C|214,2AW7|1|A|G|203:2AW7|1|A|C|206,2AW7|1|A|G|933:2AW7|1|A|A|935,2AW7|1|A|U|1380:2AW7|1|A|C|1384,2AW7|1|A|A|371:2AW7|1|A|U|375,2AW7|1|A|A|389:2AW7|1|A|U|390,2AW7|1|A|A|673:2AW7|1|A|U|678,2AW7|1|A|A|712:2AW7|1|A|U|717,2AW7|1|A|G|1497:2AW7|1|A|C|1501,2AW7|1|A|G|1401:2AW7|1|A|C|1404,2AW7|1|A|C|132:2AW7|1|A|C|136,2AW7|1|A|G|227:2AW7|1|A|G|230,2AW7|1|A|G|128:2AW7|1|A|A|131,2AW7|1|A|U|231:2AW7|1|A|C|233,2AW7|1|A|C|1259:2AW7|1|A|C|1263,2AW7|1|A|G|1272:2AW7|1|A|G|1276,2AW7|1|A|G|1124:2AW7|1|A|C|1128,2AW7|1|A|G|1144:2AW7|1|A|C|1149,2AW7|1|A|C|67:2AW7|1|A|G|69,2AW7|1|A|C|99:2AW7|1|A|G|102,2AW7|1|A|U|103:2AW7|1|A|G|104,2AW7|1|A|C|63:2AW7|1|A|A|66,2AW7|1|A|C|880:2AW7|1|A|G|881,2AW7|1|A|C|569:2AW7|1|A|G|575,2AW7|1|A|G|597:2AW7|1|A|U|598,2AW7|1|A|A|640:2AW7|1|A|C|643,2AW7|1|A|A|1329:2AW7|1|A|G|1334,2AW7|1|A|C|1303:2AW7|1|A|U|1308,2AW7|1|A|U|70:2AW7|1|A|C|73,2AW7|1|A|G|97:2AW7|1|A|A|98,2AW7|1|A|G|993:2AW7|1|A|U|997,2AW7|1|A|A|1044:2AW7|1|A|C|1045,2AW7|1|A|G|887:2AW7|1|A|G|894,2AW7|1|A|U|905:2AW7|1|A|C|910,2AW7|1|A|U|552:2AW7|1|A|A|553,2AW7|1|A|U|30:2AW7|1|A|A|32,2AW7|1|A|C|1208:2AW7|1|A|C|1209,2AW7|1|A|G|1048:2AW7|1|A|G|1050,2AW7|1|A|C|392:2AW7|1|A|A|393,2AW7|1|A|U|367:2AW7|1|A|G|369,2AW7|1|A|A|44:2AW7|1|A|G|45,2AW7|1|A|C|396:2AW7|1|A|U|398,2AW7|1|A|C|470:2AW7|1|A|U|471,2AW7|1|A|A|460:2AW7|1|A|G|462,2AW7|1|A|U|1390:2AW7|1|A|U|1391,2AW7|1|A|G|925:2AW7|1|A|G|927,2AW7|1|A|G|75:2AW7|1|A|G|76,2AW7|1|A|U|93:2AW7|1|A|C|95,2AW7|1|A|U|375:2AW7|1|A|G|376,2AW7|1|A|U|387:2AW7|1|A|A|389,2AW7|1|A|G|922:2AW7|1|A|A|923,2AW7|1|A|U|1393:2AW7|1|A|C|1395,2AW7|1|A|U|1060:2AW7|1|A|G|1061,2AW7|1|A|C|1195:2AW7|1|A|A|1197,2AW7|1|A|U|304:2AW7|1|A|C|308,2AW7|1|A|G|292:2AW7|1|A|G|293,2AW7|1|A|C|47:2AW7|1|A|C|52,2AW7|1|A|G|359:2AW7|1|A|G|361"

ranges = ConvertIDRangeString(correspondences,NTrange)

print ranges

FASTAFile = 'C:\\Users\\zirbel\\Documents\\16S sequences\\greengenes_extract2.txt'

RetrieveColumnsFromAlignment(ranges,FASTAFile,'2AW7_Motif_from_GG16S2012.txt')

